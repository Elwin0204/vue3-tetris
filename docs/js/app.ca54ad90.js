(function(){"use strict";var e={6579:function(e,t,a){var s=a(9242),o=a(3396);function r(e,t,a,s,r,n){const l=(0,o.up)("hi-tetris");return(0,o.wg)(),(0,o.j4)(l)}const n=(e,t)=>{if(e.install=a=>{for(const s of[e,...Object.values(t??{})])a.component(s.name,s)},t)for(const[a,s]of Object.entries(t))e[a]=s;return e};var l=a(7139);const i={class:"screen"},c={class:"panel"},u={class:"state"},d={class:"bottom"};function m(e,t,a,s,r,n){const m=(0,o.up)("hi-decorator"),p=(0,o.up)("hi-matrix"),v=(0,o.up)("hi-logo"),f=(0,o.up)("hi-point"),b=(0,o.up)("hi-number"),h=(0,o.up)("hi-next"),y=(0,o.up)("hi-music"),g=(0,o.up)("hi-pause"),k=(0,o.up)("hi-keyboard");return(0,o.wg)(),(0,o.iD)("div",{class:"app",style:(0,l.j5)(e.size)},[(0,o._)("div",{class:(0,l.C_)(["rect",e.drop?"drop":""])},[(0,o.Wm)(m),(0,o._)("div",i,[(0,o._)("div",c,[(0,o.Wm)(p,{propMatrix:e.matrix,cur:e.cur,reset:e.reset},null,8,["propMatrix","cur","reset"]),(0,o.Wm)(v,{cur:!!e.cur,reset:e.reset},null,8,["cur","reset"]),(0,o._)("div",u,[(0,o.Wm)(f,{cur:!!e.cur,max:e.max,point:e.points},null,8,["cur","max","point"]),(0,o._)("p",null,(0,l.zw)(e.cur?e.$t("cleans"):e.$t("startLine")),1),(0,o.Wm)(b,{number:e.cur?e.clearLines:e.startLines},null,8,["number"]),(0,o._)("p",null,(0,l.zw)(e.$t("level")),1),(0,o.Wm)(b,{number:e.cur?e.speedRun:e.speedStart,length:1},null,8,["number"]),(0,o._)("p",null,(0,l.zw)(e.$t("nextText")),1),(0,o.Wm)(h,{data:e.next},null,8,["data"]),(0,o._)("div",d,[(0,o.Wm)(y,{data:e.music},null,8,["data"]),(0,o.Wm)(g,{data:e.pause},null,8,["data"]),(0,o.Wm)(b,{propTime:!0})])])])])],2),(0,o.Wm)(k,{filling:e.filling},null,8,["filling"])],4)}var p=a(4870),v=a(65);function f(e,t){const a=(0,v.oR)(),s=t(e),r={};return Object.keys(s).forEach((e=>{const t=s[e].bind({$store:a});r[e]=(0,o.Fl)(t)})),r}function b(e){return Object.prototype.toString.call(e)}function h(e){return e=e.replace(/&nbsp;/gi,""),e=e.replace(/\s$/,""),e}function y(e,t=""){let a=v.rn;return"[object String]"===b(t)&&t.length>0&&(a=(0,v._p)(t).mapState),f(e,a)}const g={class:"decorator"},k=(0,o.uE)('<div class="topBorder" data-v-3e07f4a4><span class="l mr" style="width:40px;" data-v-3e07f4a4></span><span class="l mr" data-v-3e07f4a4></span><span class="l mr" data-v-3e07f4a4></span><span class="l mr" data-v-3e07f4a4></span><span class="l mr" data-v-3e07f4a4></span><span class="r ml" style="width:40px;" data-v-3e07f4a4></span><span class="r ml" data-v-3e07f4a4></span><span class="r ml" data-v-3e07f4a4></span><span class="r ml" data-v-3e07f4a4></span><span class="r ml" data-v-3e07f4a4></span></div>',1),x=(0,o.uE)('<div class="view" data-v-3e07f4a4><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><em data-v-3e07f4a4></em><b class="c" data-v-3e07f4a4></b><p data-v-3e07f4a4></p><em data-v-3e07f4a4></em><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><em data-v-3e07f4a4></em><b class="c" data-v-3e07f4a4></b><p data-v-3e07f4a4></p><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><p data-v-3e07f4a4></p><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b><p data-v-3e07f4a4></p><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b><p data-v-3e07f4a4></p><em data-v-3e07f4a4></em><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><em data-v-3e07f4a4></em><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><em data-v-3e07f4a4></em><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><em data-v-3e07f4a4></em><b class="c" data-v-3e07f4a4></b></div><div class="view l" data-v-3e07f4a4><em data-v-3e07f4a4></em><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b><p data-v-3e07f4a4></p><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b><p data-v-3e07f4a4></p><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><p data-v-3e07f4a4></p><em data-v-3e07f4a4></em><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><em data-v-3e07f4a4></em><b class="c" data-v-3e07f4a4></b><p data-v-3e07f4a4></p><b class="c" data-v-3e07f4a4></b><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><em data-v-3e07f4a4></em><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><em data-v-3e07f4a4></em><b class="c" data-v-3e07f4a4></b><p data-v-3e07f4a4></p><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b><div class="clear" data-v-3e07f4a4></div><b class="c" data-v-3e07f4a4></b></div>',2);function w(e,t,a,s,r,n){return(0,o.wg)(),(0,o.iD)("div",g,[k,(0,o._)("h1",null,(0,l.zw)(e.$t("title")),1),x])}var _=(0,o.aZ)({name:"Decorator",setup(){}}),S=a(89);const I=(0,S.Z)(_,[["render",w],["__scopeId","data-v-3e07f4a4"]]);var L=I;const T=n(L);var E=T;a(7658),a(2801);const H={I:[[1,1,1,1]],L:[[0,0,1],[1,1,1]],J:[[1,0,0],[1,1,1]],Z:[[1,1,0],[0,1,1]],S:[[0,1,1],[1,1,0]],O:[[1,1],[1,1]],T:[[0,1,0],[1,1,1]]},O={I:[[-1,1],[1,-1]],L:[[0,0]],J:[[0,0]],Z:[[0,0]],S:[[0,0]],O:[[0,0]],T:[[0,0],[1,0],[-1,1],[0,-1]]},N=[0,0,0,0,0,0,0,0,0,0],D=(()=>{const e=[];for(let t=0;t<20;t++)e.push(N);return e})(),R=999999,Z=Object.keys(H),C=[800,650,500,370,250,160],P=[50,60,70,80,90,100],$=[1,1,1,1,1,1,1,1,1,1],z=[100,300,700,1500],M=20,j="VUE_TETRIS",B=(()=>{let e,t=window.localStorage.getItem(j);if(!t)return!1;try{"function"===typeof window.atob&&(t=atob(t)),t=decodeURIComponent(t),e=JSON.parse(t)}catch(a){return window.console&&window.console.error&&window.console.error("Error reading record:",a),!1}return e})(),W=()=>{const e=["transform","webkitTransform","msTransform","mozTransform","oTransform"],t=document.body;return e.filter((e=>void 0!==t.style[e]))[0]},A=(()=>{let e=["hidden","webkitHidden","mozHidden","msHidden"];return e=e.filter((e=>e in document)),e.length>0&&e[0]})(),F={isMobile(){const e=navigator.userAgent,t=/Android (\d+\.\d+)/.test(e),a=e.indexOf("iPhone")>-1,s=e.indexOf("iPod")>-1,o=e.indexOf("iPad")>-1,r=e.indexOf("NokiaN")>-1;return t||a||s||o||r},visibilityChangeEvent:(()=>!!A&&A.replace(/hidden/i,"visibilitychange"))(),isFocus:()=>!A||!document[A],getNextType(){const e=Z.length;return Z[Math.floor(Math.random()*e)]},want(e,t){const a=e.xy,s=e.shape,o=s[0].length;return s.every(((e,s)=>e.every(((e,r)=>!(a[1]<0)&&(!(a[1]+o>10)&&(a[0]+s<0||!(a[0]+s>=20)&&(!e||!t[a[0]+s][a[1]+r])))))))},isClear(e){const t=[];return e.forEach(((e,a)=>{e.every((e=>!!e))&&t.push(a)})),0!==t.length&&t},isOver(e){return e[0].some((e=>!!e))}},{isMobile:J,visibilityChangeEvent:Y,isFocus:K,getNextType:U,want:q,isClear:G,isOver:Q}=F;a(541);var V=a(7327);class X{constructor(e){if((0,V.Z)(this,"type",void 0),(0,V.Z)(this,"rotateIndex",void 0),(0,V.Z)(this,"timeStamp",void 0),(0,V.Z)(this,"shape",void 0),(0,V.Z)(this,"xy",void 0),this.type=e.type,this.rotateIndex=e.rotateIndex?e.rotateIndex:0,this.timeStamp=e.timeStamp?e.timeStamp:Date.now(),this.shape=e.shape?e.shape:H[e.type],this.xy=[],e.xy)this.xy=e.xy;else switch(e.type){case"I":this.xy=[0,3];break;case"L":this.xy=[-1,4];break;case"J":this.xy=[-1,4];break;case"Z":this.xy=[-1,4];break;case"S":this.xy=[-1,4];break;case"O":this.xy=[-1,4];break;case"T":this.xy=[-1,4];break;default:break}}rotate(){const e=this.shape,t=[];e.forEach((e=>e.forEach(((a,s)=>{const o=e.length-s-1;void 0===t[o]&&(t[o]=[]),t[o].push(a);const r=[...t[o]];t[o]=r}))));const a=[this.xy[0]+O[this.type][this.rotateIndex][0],this.xy[1]+O[this.type][this.rotateIndex][1]],s=this.rotateIndex+1>=O[this.type].length?0:this.rotateIndex+1;return{shape:t,type:this.type,xy:a,rotateIndex:s,timeStamp:this.timeStamp}}fall(e=1){return{shape:this.shape,type:this.type,xy:[this.xy[0]+e,this.xy[1]],rotateIndex:this.rotateIndex,timeStamp:Date.now()}}right(){return{shape:this.shape,type:this.type,xy:[this.xy[0],this.xy[1]+1],rotateIndex:this.rotateIndex,timeStamp:this.timeStamp}}left(){return{shape:this.shape,type:this.type,xy:[this.xy[0],this.xy[1]-1],rotateIndex:this.rotateIndex,timeStamp:this.timeStamp}}}var ee=X;const te=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.oAudioContext||window.msAudioContext,ae={data:!!te&&-1!==location.protocol.indexOf("http")},se={killStart:()=>{},start:()=>{},clear:()=>{},fall:()=>{},gameover:()=>{},rotate:()=>{},move:()=>{}};(()=>{if(!ae.data)return;const e="./static/music.mp3",t=new te,a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{t.decodeAudioData(a.response,(e=>{const a=()=>{const a=t.createBufferSource();return a.buffer=e,a.connect(t.destination),a};se.killStart=()=>{se.start=()=>{}},se.start=()=>{se.killStart(),ye.state.music&&a().start(0,3.7202,3.6224)},se.clear=()=>{ye.state.music&&a().start(0,0,.7675)},se.fall=()=>{ye.state.music&&a().start(0,1.2558,.3546)},se.gameover=()=>{ye.state.music&&a().start(0,8.1276,1.1437)},se.rotate=()=>{ye.state.music&&a().start(0,2.2471,.0807)},se.fall=()=>{ye.state.music&&a().start(0,2.9088,.1437)}}),(t=>{window.console&&window.console.error&&(window.console.error(`Music: ${e} read error`,t),ae.data=!1)}))},a.send()})();const oe=!(!B||void 0===B.lock)&&!!B.lock,re=!(!B||!B.reset)&&!!B.reset,ne=(()=>{if(!B||!B.cur)return null;const e=B.cur,t={type:e.type,rotateIndex:e.rotateIndex,shape:e.shape,xy:e.xy};return new ee(t)})(),le=B&&Array.isArray(B.matrix)?B.matrix:D;let ie=!B||void 0===B.music||!!B.music;ae.data||(ie=!1);let ce=B&&!isNaN(parseInt(B.max,10))?parseInt(B.max,10):0;ce<0?ce=0:ce>R&&(ce=R);let ue=B&&!isNaN(parseInt(B.speedStart,10))?parseInt(B.speedStart,10):1;(ue<1||ue>6)&&(ue=1);let de=B&&!isNaN(parseInt(B.startLines,10))?parseInt(B.startLines,10):0;(de<0||de>10)&&(de=0);const me=B&&-1!==Z.indexOf(B.next)?B.next:U();let pe=B&&!isNaN(parseInt(B.speedRun.toString(),10))?parseInt(B.speedRun.toString(),10):1;(pe<1||pe>6)&&(pe=1);let ve=B&&!isNaN(parseInt(B.points.toString(),10))?parseInt(B.points.toString(),10):0;ve<0?ve=0:ve>R&&(ve=R);const fe=!(!B||void 0===B.pause)&&!!B.pause;let be=B&&!isNaN(parseInt(B.clearLines.toString(),10))?parseInt(B.clearLines.toString(),10):0;be<0&&(be=0);const he=!(!B||void 0===B.lock)&&!!B.lock;var ye=(0,v.MT)({state:{drop:oe,cur:ne,reset:re,matrix:le,music:ie,max:ce,speedStart:ue,startLines:de,next:me,speedRun:pe,points:ve,pause:fe,clearLines:be,keyboard:{drop:!1,down:!1,left:!1,right:!1,rotate:!1,reset:!1,music:!1,pause:!1},lock:he,focus:K()},getters:{},mutations:{nextBlock(e,t){t||(t=U()),e.next=t},moveBlock(e,t){e.cur=!0===t.reset?null:new ee(t)},speedStart(e,t){e.speedStart=t},speedRun(e,t){e.speedRun=t},startLines(e,t){e.startLines=t},matrix(e,t){e.matrix=t},lock(e,t){e.lock=t},clearLines(e,t){e.clearLines=t},points(e,t){e.points=t},max(e,t){e.max=t},reset(e,t){e.reset=t},drop(e,t){e.drop=t},pause(e,t){e.pause=t},music(e,t){e.music=t},focus(e,t){e.focus=t},key_drop(e,t){e.keyboard["drop"]=t},key_down(e,t){e.keyboard["down"]=t},key_left(e,t){e.keyboard["left"]=t},key_right(e,t){e.keyboard["right"]=t},key_rotate(e,t){e.keyboard["rotate"]=t},key_reset(e,t){e.keyboard["reset"]=t},key_music(e,t){e.keyboard["music"]=t},key_pause(e,t){e.keyboard["pause"]=t}}});const ge=e=>{const t=(e,t)=>{const a=parseInt(((t-e+1)*Math.random()+e).toString(),10),s=[];for(let o=0;o<a;o++)s.push(1);for(let o=0,r=10-a;o<r;o++){const e=parseInt(((s.length+1)*Math.random()).toString(),10);s.splice(e,0,0)}return s},a=[];for(let s=0;s<e;s++)s<=2?a.push(t(5,8)):s<=6?a.push(t(4,9)):a.push(t(3,9));for(let s=0,o=20-e;s<o;s++)a.unshift(N);return a},ke={fallInterval:void 0,start:()=>{se.start&&se.start();const e=ye.state;ke.dispatchPoints(0),ye.commit("speedRun",e.speedStart);const t=e.startLines,a=ge(t);ye.commit("matrix",a),ye.commit("moveBlock",{type:e.next}),ye.commit("nextBlock",""),ke.auto()},auto:(e=0)=>{const t=e<0?0:e;let a=ye.state,s=a.cur;const o=()=>{a=ye.state,s=a.cur;const e=s.fall();if(q(e,a.matrix))ye.commit("moveBlock",e),ke.fallInterval=setTimeout(o,C[a.speedRun-1]);else{const e=JSON.parse(JSON.stringify(a.matrix)),t=s&&s.shape,o=s&&s.xy;t.forEach(((t,a)=>t.forEach(((t,s)=>{if(t&&o[0]+a>=0){const t=e[o[0]+a];t[o[1]+s]=1,e[o[0]+a]=t}})))),ke.nextAround(e)}};clearTimeout(ke.fallInterval),ke.fallInterval=setTimeout(o,void 0===t||0===t?C[a.speedRun-1]:t)},nextAround:(e,t)=>{clearTimeout(ke.fallInterval),ye.commit("lock",!0),ye.commit("matrix",e),"function"===typeof t&&t();const a=ye.state.points+10+2*(ye.state.speedRun-1);if(ke.dispatchPoints(a),!G(e))return Q(e)?(se.gameover&&se.gameover(),void ke.overStart()):void setTimeout((()=>{ye.commit("lock",!1),ye.commit("moveBlock",{type:ye.state.next}),ye.commit("nextBlock",""),ke.auto()}),100);se.clear&&se.clear()},focus:e=>{if(ye.commit("focus",e),!e)return void clearTimeout(ke.fallInterval);const t=ye.state;!t.cur||t.reset||t.pause||ke.auto()},pause:e=>{ye.commit("pause",e),e?clearTimeout(ke.fallInterval):ke.auto()},clearLines:(e,t)=>{const a=ye.state,s=JSON.parse(JSON.stringify(e));t.forEach((e=>{s.splice(e,1),s.unshift(N)})),ye.commit("matrix",s),ye.commit("moveBlock",{type:a.next}),ye.commit("nextBlock",""),ke.auto(),ye.commit("lock",!1);const o=a.clearLines+t.length;ye.commit("clearLines",o);const r=ye.state.points+z[t.length-1];ke.dispatchPoints(r);const n=Math.floor(o/M);let l=a.speedStart+n;l=l>6?6:l,ye.commit("speedRun",l)},overStart:()=>{clearTimeout(ke.fallInterval),ye.commit("lock",!0),ye.commit("reset",!0),ye.commit("pause",!1)},overEnd:()=>{ye.commit("matrix",D),ye.commit("moveBlock",{reset:!0}),ye.commit("reset",!1),ye.commit("lock",!1),ye.commit("clearLines",0)},dispatchPoints:e=>{ye.commit("points",e),e>0&&e>ye.state.max&&ye.commit("max",e)}};var xe=ke;const we=setTimeout;var _e=(0,o.aZ)({name:"Matrix",props:["cur","reset","propMatrix"],setup(e){let t=(0,p.iH)(!1),a=(0,p.iH)(2),s=(0,p.iH)(!1),r=(0,p.iH)(null);const n=e=>{const s=e.cur,o=s&&s.shape,r=s&&s.xy;let n=JSON.parse(JSON.stringify(e.propMatrix));const l=t.value;if(l){const e=a.value;l.forEach((t=>{n[t]=[e,e,e,e,e,e,e,e,e,e]}))}else o&&o.forEach(((e,a)=>e.forEach(((e,s)=>{if(e&&r[0]+a>=0){let e,o=n[r[0]+a];e=1!==o[r[1]+s]||t.value?1:2,o[r[1]+s]=e,n[r[0]+a]=o}}))));return n},l=()=>{const s=e=>{we((()=>{a.value=0,we((()=>{a.value=2,"function"===typeof e&&e()}),100)}),100)};s((()=>{s((()=>{s((()=>{we((()=>{xe.clearLines(e.propMatrix,t.value)}),100)}))}))}))},i=e=>{const t=n(e);r.value=[...t];const a=e=>{if(e<=19)r.value[19-e]=$;else{if(!(e>=20&&e<=39))return void xe.overEnd();r.value[e-20]=N}r.value=[...t]};for(let s=0;s<=40;s++)we(a.bind(null,s),40*(s+1))},c=e=>{const a=G(e.propMatrix),o=e.reset;setTimeout((()=>{t.value=a,s.value=o}),0),a&&!t.value&&l(),a||!o||s.value||i(e)};return(0,o.YP)(e,(e=>{c(e)}),{immediate:!0,deep:!0}),()=>{let t=[];return t=s.value?r.value:n(e),(0,o.Wm)("div",{class:"matrix"},[t.map((e=>(0,o.Wm)("p",null,[e.map((e=>(0,o.Wm)("b",{class:(1===e?"c":"")+(2===e?"d":"")},null)))])))])}}});const Se=(0,S.Z)(_e,[["__scopeId","data-v-296809e8"]]);var Ie=Se;const Le=n(Ie);var Te=Le;function Ee(e,t,a,s,r,n){const i=(0,o.Q2)("dompurify-html");return(0,o.wg)(),(0,o.iD)("div",{class:"logo",style:(0,l.j5)(`display:${e.display}`)},[(0,o._)("div",{class:(0,l.C_)(["bg dragon",e.style])},null,2),(0,o.wy)((0,o._)("p",null,null,512),[[i,e.titleCenter]])],4)}var He=a(5658),Oe={title:"Tetris",titleCenter:"TETRIS",highestScore:"Max",lastRound:"Last Round",point:"Point",cleans:"Cleans",startLine:"Start Line",level:"Level",nextText:"Next",rotation:"Rotation",left:"Left",right:"Right",down:"Down",drop:"Drop",reset:"Reset",sound:"Sound",pause:"Pause"},Ne={title:"俄罗斯方块",titleCenter:"俄罗斯方块<br />TETRIS",highestScore:"最高分",lastRound:"上轮得分",point:"得分",cleans:"消除行",startLine:"起始行",level:"级别",nextText:"下一个",rotation:"旋转",left:"左移",right:"右移",down:"下移",drop:"掉落",reset:"重玩",sound:"音效",pause:"暂停"};const De=(0,He.o)({locale:localStorage.getItem("lang")||"zhCN",messages:{en:Oe,zhCN:Ne}});var Re=De;let Ze={timeout:void 0};var Ce=(0,o.aZ)({name:"Logo",props:["cur","reset"],setup(e){const t=(0,p.iH)("r1"),a=(0,p.iH)("none"),s=(0,o.Fl)((()=>h(Re.global.t("titleCenter")))),r=({cur:e,reset:s})=>{if(clearTimeout(Ze.timeout),t.value="r1",a.value="none",e||s)return void(a.value="none");let o=(0,p.iH)("r"),r=(0,p.iH)(0);const n=(e,t)=>{e&&(Ze.timeout=setTimeout(e,t))},l=e=>{n((()=>{a.value="block","[object Function]"===b(e)&&e()}),150)},i=e=>{n((()=>{a.value="none","[object Function]"===b(e)&&e()}),150)},c=(e,a,s)=>{n((()=>{t.value=o.value+2,n((()=>{t.value=o.value+1,"[object Function]"===b(e)&&e()}),s)}),a)},u=e=>{n((()=>{t.value=o.value+4,n((()=>{t.value=o.value+3,r.value++,10!==r.value&&20!==r.value&&30!==r.value||(o.value="r"===o.value?"l":"r"),r.value<40?u(e):(t.value=o.value+1,"[object Function]"===b(e)&&n(e,4e3))}),100)}),100)},d=()=>{r.value=0,c((()=>{c((()=>{c((()=>{t.value=o.value+2,u(d)}),150,150)}),150,150)}),1e3,1500)};l((()=>{i((()=>{l((()=>{i((()=>{l((()=>{d()}))}))}))}))}))};return(0,o.YP)(e,((e,t)=>{r(e),(t&&-1!==[t.cur,e.cur].indexOf(!1)&&t.cur!==e.cur||t&&t.reset!==e.reset)&&r(e)}),{immediate:!0,deep:!0}),(0,o.bv)((()=>{r(e)})),{style:t,display:a,titleCenter:s}}});const Pe=(0,S.Z)(Ce,[["render",Ee],["__scopeId","data-v-af3c2d04"]]);var $e=Pe;const ze=n($e);var Me=ze;function je(e,t,a,s,r,n){const i=(0,o.up)("hi-button");return(0,o.wg)(),(0,o.iD)("div",{class:"keyboard",style:(0,l.j5)(`margin-top:${e.fillingNum}px;`)},[(0,o.Wm)(i,{color:"blue",size:"s1",top:0,left:104,label:e.labelDropSpace,arrow:"translate(0, 63px)",position:!0,active:e.keyboard["drop"],ref:"dom_space"},null,8,["label","active"]),(0,o.Wm)(i,{color:"blue",size:"s1",top:180,left:104,label:e.labelDown,arrow:"translate(0,-71px) rotate(180deg)",active:e.keyboard["down"],ref:"dom_down"},null,8,["label","active"]),(0,o.Wm)(i,{color:"blue",size:"s1",top:90,left:14,label:e.labelLeft,arrow:"translate(60px, -12px) rotate(270deg)",active:e.keyboard["left"],ref:"dom_left"},null,8,["label","active"]),(0,o.Wm)(i,{color:"blue",size:"s1",top:90,left:194,label:e.labelRight,arrow:"translate(-60px, -12px) rotate(90deg)",active:e.keyboard["right"],ref:"dom_right"},null,8,["label","active"]),(0,o.Wm)(i,{color:"red",size:"s2",top:0,left:336,label:e.labelResetR,active:e.keyboard["reset"],ref:"dom_r"},null,8,["label","active"]),(0,o.Wm)(i,{color:"green",size:"s2",top:0,left:426,label:e.labelSoundS,active:e.keyboard["music"],ref:"dom_s"},null,8,["label","active"]),(0,o.Wm)(i,{color:"green",size:"s2",top:0,left:516,label:e.labelPauseP,active:e.keyboard["pause"],ref:"dom_p"},null,8,["label","active"]),(0,o.Wm)(i,{color:"blue",size:"s0",top:100,left:374,label:e.rotation,active:e.keyboard["rotate"],ref:"dom_rotate"},null,8,["label","active"])],4)}function Be(e,t,a,r,n,i){return(0,o.wg)(),(0,o.iD)("div",{class:(0,l.C_)(["button",e.color+" "+e.size]),style:(0,l.j5)("top:"+e.top+"px;left:"+e.left+"px")},[(0,o._)("i",{class:(0,l.C_)({active:e.active})},null,2),(0,o.wy)((0,o._)("em",{style:(0,l.j5)("transform:"+e.arrow+" scale(1,2)")},null,4),[[s.F8,"s1"===e.size]]),(0,o._)("span",{class:(0,l.C_)(e.position?"position":"")},(0,l.zw)(e.label),3)],6)}var We=(0,o.aZ)({name:"Button",props:["active","color","size","top","left","label","position","arrow"],setup(){W()}});const Ae=(0,S.Z)(We,[["render",Be],["__scopeId","data-v-1f7c6bc1"]]);var Fe=Ae;const Je=n(Fe);var Ye=Je;const Ke={},Ue=e=>{const t=Object.keys(Ke);if(t.forEach((e=>{clearTimeout(Ke[e]),Ke[e]=null})),!e.callback)return;const a=()=>{clearTimeout(Ke[e.key])};if(e.callback(a),!0===e.once)return;let s=e.begin||100;const o=e.interval||50,r=()=>{Ke[e.key]=setTimeout((()=>{s=null,r(),e.callback&&e.callback(a)}),s||o)};r()},qe=e=>{clearTimeout(Ke[e.key]),Ke[e.key]=null,e.callback&&e.callback(void 0)},Ge=()=>{const e=Object.keys(Ke);e.forEach((e=>{clearTimeout(Ke[e]),Ke[e]=null}))};var Qe={down:Ue,up:qe,clearAll:Ge};const Ve=e=>{e.commit("key_left",!0),Qe.down({key:"left",begin:200,interval:100,callback:()=>{const t=e.state;if(t.lock)return;se.move&&se.move();const a=t.cur;if(null!==a){if(t.pause)return void xe.pause(!1);const s=a.left(),o=P[t.speedRun-1];let r;q(s,t.matrix)?(s.timeStamp+=parseInt(o.toString(),10),e.commit("moveBlock",s),r=s.timeStamp):(a.timeStamp+=parseInt((parseInt(o.toString(),10)/1.5).toString(),10),e.commit("moveBlock",a),r=a.timeStamp);const n=C[t.speedRun-1]-(Date.now()-r);xe.auto(n)}else{let a=t.speedStart;a=a-1<1?6:a-1,e.commit("speedStart",a)}}})},Xe=e=>{e.commit("key_left",!1),Qe.up({key:"left"})};var et={down:Ve,up:Xe};const tt=e=>{e.commit("key_right",!0),Qe.down({key:"right",begin:200,interval:100,callback:()=>{const t=e.state;if(t.lock)return;se.move&&se.move();const a=t.cur;if(null!==a){if(t.pause)return void xe.pause(!1);const s=a.right(),o=P[t.speedRun-1];let r;q(s,t.matrix)?(s.timeStamp+=parseInt(o.toString(),10),e.commit("moveBlock",s),r=s.timeStamp):(a.timeStamp+=parseInt((parseInt(o.toString(),10)/1.5).toString(),10),e.commit("moveBlock",a),r=a.timeStamp);const n=C[t.speedRun-1]-(Date.now()-r);xe.auto(n)}else{let a=t.speedStart;a=a+1>6?1:a+1,e.commit("speedStart",a)}}})},at=e=>{e.commit("key_right",!1),Qe.up({key:"right"})};var st={down:tt,up:at};const ot=e=>{e.commit("key_down",!0),null!==e.state.cur?Qe.down({key:"down",begin:40,interval:40,callback:t=>{const a=e.state;if(a.lock)return;se.move&&se.move();const s=a.cur;if(null===s)return;if(a.pause)return void xe.pause(!1);const o=s.fall();if(q(o,a.matrix))e.commit("moveBlock",o),xe.auto();else{const e=JSON.parse(JSON.stringify(a.matrix)),o=s.shape,r=s.xy;o.forEach(((t,a)=>t.forEach(((t,s)=>{if(t&&r[0]+a>=0){const t=e[r[0]+a];t[r[1]+s]=1,e[r[0]+a]=t}})))),xe.nextAround(e,t)}}}):Qe.down({key:"down",begin:200,interval:100,callback:()=>{if(e.state.lock)return;const t=e.state,a=t.cur;if(a)return;se.move&&se.move();let s=t.startLines;s=s-1<0?10:s-1,e.commit("startLines",s)}})},rt=e=>{e.commit("key_down",!1),Qe.up({key:"down"})};var nt={down:ot,up:rt};const lt=e=>{e.commit("key_rotate",!0),null!==e.state.cur?Qe.down({key:"rotate",once:!0,callback:()=>{const t=e.state;if(t.lock)return;t.pause&&xe.pause(!1);const a=t.cur;if(null===a)return;se.rotate&&se.rotate();const s=a.rotate();q(s,t.matrix)&&e.commit("moveBlock",s)}}):Qe.down({key:"rotate",begin:200,interval:100,callback:()=>{if(e.state.lock)return;se.move&&se.move();const t=e.state,a=t.cur;if(a)return;let s=t.startLines;s=s+1>10?0:s+1,e.commit("startLines",s)}})},it=e=>{e.commit("key_rotate",!1),Qe.up({key:"rotate"})};var ct={down:lt,up:it};const ut=e=>{e.commit("key_drop",!0),Qe.down({key:"space",once:!0,callback:()=>{const t=e.state;if(t.lock)return;const a=t.cur;if(null!==a){if(t.pause)return void xe.pause(!1);se.fall&&se.fall();let s=0,o=a.fall(s);while(q(o,t.matrix))o=a.fall(s),s++;const r=JSON.parse(JSON.stringify(t.matrix));o=a.fall(s-2),e.commit("moveBlock",o);const n=o.shape,l=o.xy;n.forEach(((e,t)=>e.forEach(((e,a)=>{if(e&&l[0]+t>=0){const e=r[l[0]+t];e[l[1]+a]=1,r[l[0]+t]=e}})))),e.commit("drop",!0),setTimeout((()=>{e.commit("drop",!1)}),100),xe.nextAround(r)}else xe.start()}})},dt=e=>{e.commit("key_drop",!1),Qe.up({key:"space"})};var mt={down:ut,up:dt};const pt=e=>{e.commit("key_music",!0),e.state.lock||(Qe.down({key:"s",once:!0,callback:()=>{e.state.lock||e.commit("music",!e.state.music)}}),console.log("down"))},vt=e=>{console.log("up"),e.commit("key_music",!1),Qe.up({key:"s"})};var ft={down:pt,up:vt};const bt=e=>{e.commit("key_reset",!0),e.state.lock||(null!==e.state.cur?Qe.down({key:"r",once:!0,callback:()=>{xe.overStart()}}):Qe.down({key:"r",once:!0,callback:()=>{e.state.lock||xe.start()}}))},ht=e=>{e.commit("key_reset",!1),Qe.up({key:"r"})};var yt={down:bt,up:ht};const gt=e=>{e.commit("key_pause",!0),Qe.down({key:"p",once:!0,callback:()=>{const t=e.state;if(t.lock)return;const a=t.cur,s=t.pause;null!==a?xe.pause(!s):xe.start()}})},kt=e=>{e.commit("key_pause",!1),Qe.up({key:"p"})};var xt={down:gt,up:kt},wt={left:et,down:nt,rotate:ct,right:st,space:mt,r:yt,p:xt,s:ft},_t=(0,o.aZ)({name:"Keyboard",components:{HiButton:Ye},props:{filling:Number},setup(e){let t=(0,p.iH)(0);(0,o.m0)((()=>{t.value=e.filling+20}));const a=y(["keyboard"]),s=(0,o.Fl)((()=>Re.global.t("rotation"))),r=(0,o.Fl)((()=>Re.global.t("left"))),n=(0,o.Fl)((()=>Re.global.t("right"))),l=(0,o.Fl)((()=>Re.global.t("down"))),i=(0,o.Fl)((()=>`${Re.global.t("drop")} (SPACE)`)),c=(0,o.Fl)((()=>`${Re.global.t("reset")}(R)`)),u=(0,o.Fl)((()=>`${Re.global.t("sound")}(S)`)),d=(0,o.Fl)((()=>`${Re.global.t("pause")}(P)`)),m=(0,p.iH)(),v=(0,p.iH)(),f=(0,p.iH)(),b=(0,p.iH)(),h=(0,p.iH)(),g=(0,p.iH)(),k=(0,p.iH)(),x=(0,p.iH)(),w={dom_space:m,dom_down:v,dom_left:f,dom_right:b,dom_r:h,dom_s:g,dom_p:k,dom_rotate:x};return(0,o.bv)((()=>{const e={},t={};document.addEventListener("touchstart",(e=>{e.preventDefault&&e.preventDefault()}),{capture:!0,passive:!1}),document.addEventListener("touchend",(e=>{e.preventDefault&&e.preventDefault()}),!0),document.addEventListener("gesturestart",(e=>{e.preventDefault()})),document.addEventListener("mousedown",(e=>{e.preventDefault&&e.preventDefault()}),!0),Object.keys(wt).forEach((a=>{w[`dom_${a}`].value.$el.addEventListener("mousedown",(()=>{!0!==e[a]&&(wt[a].down(ye),t[a]=!0)}),!0),w[`dom_${a}`].value.$el.addEventListener("mouseup",(()=>{!0!==e[a]?(wt[a].up(ye),t[a]=!1):e[a]=!1}),!0),w[`dom_${a}`].value.$el.addEventListener("mouseout",(()=>{!0===t[a]&&wt[a].up(ye)}),!0),w[`dom_${a}`].value.$el.addEventListener("touchstart",(()=>{e[a]=!0,wt[a].down(ye)}),!0),w[`dom_${a}`].value.$el.addEventListener("touchend",(()=>{wt[a].up(ye)}),!0)}))})),{fillingNum:t,...a,rotation:s,labelLeft:r,labelRight:n,labelDown:l,labelDropSpace:i,labelResetR:c,labelSoundS:u,labelPauseP:d,dom_space:m,dom_down:v,dom_left:f,dom_right:b,dom_r:h,dom_s:g,dom_p:k,dom_rotate:x}}});const St=(0,S.Z)(_t,[["render",je],["__scopeId","data-v-549f1fae"]]);var It=St;const Lt=n(It);var Tt=Lt;const Et={class:"point"};function Ht(e,t,a,s,r,n){const i=(0,o.up)("hi-number");return(0,o.wg)(),(0,o.iD)("div",Et,[(0,o._)("p",null,(0,l.zw)(e.label),1),(0,o.Wm)(i,{number:e.number,onSetLength:e.setLength},null,8,["number","onSetLength"])])}const Ot={class:"number"};function Nt(e,t,a,s,r,n){return(0,o.wg)(),(0,o.iD)("div",Ot,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.dataList,((e,t)=>((0,o.wg)(),(0,o.iD)("span",{key:t,class:(0,l.C_)("bg s_"+e)},null,2)))),128))])}const Dt=e=>e<10?`0${e}`.split(""):`${e}`.split("");let Rt={timeInterval:void 0,time_count:void 0};var Zt=(0,o.aZ)({name:"Number",props:{propTime:{type:Boolean},number:{type:Number},length:{type:Number,default:6}},setup(e,{emit:t}){let a=new Date;const s=(0,p.iH)([]),r=()=>{if(e.propTime){const e=a,t=Dt(e.getHours()),o=Dt(e.getMinutes()),r=e.getSeconds()%2,n=t.concat(r?"d":"d_c",o);return void(s.value=n)}const t=`${e.number}`.split("");for(let a=0,s=e.length-t.length;a<s;a++)t.unshift("n");s.value=t},n=()=>{Rt.timeInterval=setTimeout((()=>{a=new Date,r(),n()}),1e3)};return(0,o.YP)(e,(()=>{r()}),{immediate:!0,deep:!0}),(0,o.bv)((()=>{e.length||t("setLength",6),e.propTime&&n(),r()})),(0,o.Ah)((()=>{e.propTime&&clearTimeout(Rt.timeInterval)})),{dataList:s}}});const Ct=(0,S.Z)(Zt,[["render",Nt],["__scopeId","data-v-4d9b77f6"]]);var Pt=Ct;const $t=n(Pt);var zt=$t;const Mt=Re.global.t("point"),jt=Re.global.t("highestScore"),Bt=Re.global.t("lastRound");let Wt={timeout:void 0};var At=(0,o.aZ)({name:"Point",props:["cur","point","max"],components:{HiNumber:zt},setup(e){let t=(0,p.iH)(""),a=(0,p.iH)(0);const s=e=>{a.value=e},r=({cur:e,point:s,max:o})=>{if(clearInterval(Wt.timeout),e)t.value=s>=o?jt:Mt,a.value=s;else{const e=()=>{t.value=Bt,a.value=s,Wt.timeout=setTimeout((()=>{t.value=jt,a.value=o,Wt.timeout=setTimeout(e,3e3)}),3e3)};0!==s?e():(t.value=jt,a.value=o)}};return(0,o.YP)(e,(e=>{r(e)}),{immediate:!0,deep:!0}),{label:t,number:a,setLength:s}}});const Ft=(0,S.Z)(At,[["render",Ht],["__scopeId","data-v-93aed796"]]);var Jt=Ft;const Yt=n(Jt);var Kt=Yt;const Ut={class:"next"};function qt(e,t,a,s,r,n){return(0,o.wg)(),(0,o.iD)("div",Ut,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.block,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:t},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e,((e,t)=>((0,o.wg)(),(0,o.iD)("b",{class:(0,l.C_)(e?"c":""),key:t},null,2)))),128))])))),128))])}const Gt={I:[1,0],L:[0,0],J:[0,0],Z:[0,0],S:[0,0],O:[0,1],T:[0,0]},Qt=[[0,0,0,0],[0,0,0,0]];var Vt=(0,o.aZ)({name:"Next",props:{data:{type:String}},setup(e){const t=(0,p.iH)(Qt),a=e=>{const a=H[e],s=Qt.map((e=>[...e]));a.forEach(((t,a)=>{t.forEach(((t,o)=>{t&&(s[a+Gt[e][0]][o+Gt[e][1]]=1)}))})),t.value=s};return(0,o.YP)(e,(e=>{a(e.data)}),{immediate:!0,deep:!0}),{block:t}}});const Xt=(0,S.Z)(Vt,[["render",qt],["__scopeId","data-v-0b7ff572"]]);var ea=Xt;const ta=n(ea);var aa=ta;function sa(e,t,a,s,r,n){return(0,o.wg)(),(0,o.iD)("div",{class:(0,l.C_)(["bg music",e.data?"":"c"])},null,2)}var oa=(0,o.aZ)({name:"Music",props:{data:{type:Boolean}}});const ra=(0,S.Z)(oa,[["render",sa],["__scopeId","data-v-4493e0ad"]]);var na=ra;const la=n(na);var ia=la;function ca(e,t,a,s,r,n){return(0,o.wg)(),(0,o.iD)("div",{class:(0,l.C_)(["bg pause",{c:e.showPause}])},null,2)}let ua={timeout:void 0};var da=(0,o.aZ)({name:"Pause",props:{data:{type:Boolean}},setup(e){const t=(0,p.iH)(!1),a=e=>{e&&!ua.timeout&&(ua.timeout=setInterval((()=>{t.value=!t.value}),250)),!e&&ua.timeout&&(clearInterval(ua.timeout),t.value=!1,ua.timeout=void 0)};return(0,o.bv)((()=>{a(e.data)})),(0,o.YP)(e,(e=>{a(e.data)}),{immediate:!0,deep:!0}),{showPause:t}}});const ma=(0,S.Z)(da,[["render",ca],["__scopeId","data-v-f9670ad4"]]);var pa=ma;const va=n(pa);var fa=va,ba=(0,o.aZ)({name:"Tetris",components:{HiDecorator:E,HiMatrix:Te,HiLogo:Me,HiKeyboard:Tt,HiPoint:Kt,HiNumber:zt,HiNext:aa,HiMusic:ia,HiPause:fa},setup(){const e=y(["drop","cur","reset","matrix","max","points","startLines","clearLines","speedStart","speedRun","next","music","pause"]);let t=(0,p.iH)({}),a=(0,p.iH)(0);const s=()=>{Y&&document.addEventListener(Y,(()=>{xe.focus(K())}),!1)},r=()=>{const e=()=>{const e=document.documentElement.clientWidth,t=document.documentElement.clientHeight,s=t/e;let o,r={};return s<1.5?o=t/960:(o=e/640,a.value=(t-960*o)/o/3,r={"padding-top":Math.floor(a.value)+42+"px","padding-bottom":Math.floor(a.value)+"px","margin-top":Math.floor(-480-1.5*a.value)+"px"}),r["transform"]=`scale(${o})`,{css:r,filling:a.value}},o=e();t.value=o.css,a.value=o.filling,s()};return(0,o.bv)((()=>{r(),window.addEventListener("resize",r,!0)})),(0,o.Ah)((()=>{window.removeEventListener("resize",r,!0)})),{size:t,filling:a,...e}}});const ha=(0,S.Z)(ba,[["render",m],["__scopeId","data-v-35d10ca0"]]);var ya=ha;const ga=n(ya);var ka=ga,xa=(0,o.aZ)({name:"App",components:{HiTetris:ka}});const wa=(0,S.Z)(xa,[["render",r]]);var _a=wa,Sa=a(1264);const Ia=(0,s.ri)(_a);Ia.use(ye),Ia.use(Re),Ia.use(Sa.ZP),Ia.mount("#app")}},t={};function a(s){var o=t[s];if(void 0!==o)return o.exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,s,o,r){if(!s){var n=1/0;for(u=0;u<e.length;u++){s=e[u][0],o=e[u][1],r=e[u][2];for(var l=!0,i=0;i<s.length;i++)(!1&r||n>=r)&&Object.keys(a.O).every((function(e){return a.O[e](s[i])}))?s.splice(i--,1):(l=!1,r<n&&(n=r));if(l){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[s,o,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var o,r,n=s[0],l=s[1],i=s[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(o in l)a.o(l,o)&&(a.m[o]=l[o]);if(i)var u=i(a)}for(t&&t(s);c<n.length;c++)r=n[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(u)},s=self["webpackChunkvue3_tetris"]=self["webpackChunkvue3_tetris"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(6579)}));s=a.O(s)})();
//# sourceMappingURL=app.ca54ad90.js.map